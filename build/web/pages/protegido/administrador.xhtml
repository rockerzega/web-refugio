<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../../templates/template_priv.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:define name="content">
        <p:separator />
        <h:form>
            <!-- pueden cambiarlo con growl pero es cuestion de estilos -->
            <p:messages
                id="mensajes"
                autoUpdate="false"
                severity="info, fatal"
                showSummary="true"
                showDetail="true"
            />
            <p:fieldset legend="Datos personales">
                <h:panelGrid columns="3" id="pgAdmin">
                    <p:outputLabel for="txtNom" value="Nombre" />
                    <p:inputText id="txtNom" value="#{managedProtect.usuario.nombre}" required="true" />
                    <p:message for="txtNom" />
                    <p:outputLabel for="txtDir" value="Dirección" />
                    <p:inputText id="txtDir" value="#{managedProtect.usuario.direccion}" required="true" />
                    <p:message for="txtDir" />
                    <p:outputLabel for="dateUsr" value="Fecha Creación" />
                    <p:calendar id="dateUsr"
                                value="#{managedProtect.usuario.fechaCreacion}"
                                locale="es"
                                required="true"
                                requiredMessage="Campo requerido"
                    />
                    <p:message for="dateUsr" />
                </h:panelGrid>
            </p:fieldset>
            <p:separator />
            <p:fieldset legend="Acceso a cuenta">
                <h:panelGrid columns="3" id="pgUser">
                    <p:outputLabel for="txtUsr" value="Usuario" />
                    <p:inputText
                        id="txtUsr"
                        value="#{managedProtect.usuario.usuario}"
                        required="true"
                        requiredMessage="Campo requerido"
                    />
                    <p:message for="txtUsr" />
                    <p:outputLabel for="pass_1" value="Contraseña" />
                    <p:password
                        id="pass_1"
                        value="#{managedProtect.usuario.pass}"
                        match="pass_2"
                        feedback="true"
                        promptLabel="Debe ingresar una contraseña"
                        validatorMessage="Las contraseñas no coinciden"
                        weakLabel="Dèbil"
                        strongLabel="Fuerte"
                        goodLabel="Bueno"
                        required="true"
                        requiredMessage="Campo requerido"
                    />
                    <p:message for="pass_1" />
                    <p:outputLabel for="pass_2" value="Repetir contraseña" />
                    <p:password id="pass_2" required="true" requiredMessage="Campo requerido" />
                    <p:message for="pass_2" />
                </h:panelGrid>
            </p:fieldset>
            <p:separator />
            <p:fieldset legend="Activo">
                <h:panelGrid columns="2">
                    <p:outputLabel value="Estado" />
                    <p:selectBooleanCheckbox value="#{managedProtect.administrador.activo}" />
                </h:panelGrid>
            </p:fieldset>
            <p:separator />
            <p:commandButton
                icon="ui-icon-check"
                value="registrar"
                update="pgAdmin, pgUser, mensajes, datosTabla"
                actionListener="#{managedProtect.crearAdministrador()}"
            />
            <p:separator />
            <p:dataTable
                id="datosTabla"
                var="idx_fila"
                value="#{managedProtect.listaAdministrador}"
                rows="3"
                paginator="true"
            >
                <p:column
                    headerText="Nombre"
                    filterBy="#{idx_fila.usuario.nombre}"
                    sortBy="#{idx_fila.usuario.nombre}"
                >
                    <h:outputText value="#{idx_fila.usuario.nombre}"/>                            
                </p:column>
                <p:column
                    headerText="Dirección"
                    filterBy="#{idx_fila.usuario.direccion}"
                    sortBy="#{idx_fila.usuario.direccion}"
                >
                    <h:outputText value="#{idx_fila.usuario.direccion}"/>                            
                </p:column>
                <p:column
                    headerText="Fecha creación"
                    filterBy="#{idx_fila.usuario.fechaCreacion}"
                    sortBy="#{idx_fila.usuario.fechaCreacion}"
                >
                    <h:outputText value="#{idx_fila.usuario.fechaCreacion}">
                        <f:convertDateTime pattern="dd/MMMM/yyy" />
                    </h:outputText>                            
                </p:column>
                <p:column
                    headerText="Activo"
                    filterBy="#{idx_fila.activo}"
                    sortBy="#{idx_fila.activo}"
                >
                    <h:outputText value="#{idx_fila.activo}"/>                            
                </p:column>
                <p:column
                    headerText="Usuario"
                    filterBy="#{idx_fila.usuario.usuario}"
                    sortBy="#{idx_fila.usuario.usuario}"
                >
                    <h:outputText value="#{idx_fila.usuario.usuario}"/>                            
                </p:column>
                <p:column headerText="Modificar" >
                    <!--p:commandLink value="modificar"
                                   actionListener=""
                                   oncomplete="PF('wdlgDatos').show();"
                                   update=":dlgDatos"
                                   /-->
                </p:column>
            </p:dataTable>
        </h:form>
        <h:outputScript library="js" name="spanishLocale.js" />
    </ui:define>

    <ui:define name="bottom">
        Manejo de Administradores
    </ui:define>

</ui:composition>
